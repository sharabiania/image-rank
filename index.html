<html>
	<head>
		<style>
			img {cursor: pointer;}
			img:hover {border: 2px solid black;}
		</style>
	</head>
	<body>
		<h1 id='title'></h1>
		<img id="img-left" width="200" height="100" onclick="leftClick()"/>
		<img id="img-right" width="200" height="100" onclick="rightClick()"/>
		<button id="btn-reset" hidden="hidden" onclick="reset()">Restart</button>
		</table>
		<script>
			const TOTAL = 5;
			var imgSet = [];
			var currSet = [];
			var winners = [];
			var currWinner;
			var imgLeft = document.getElementById("img-left");
			var imgRight = document.getElementById("img-right");
			var li = 0, ri = 1;
			var endFlag = false;
			var title = document.getElementById('title');

			var img = function(name) {
				this.name = name;
				this.selected = false;
				this.rank = 0;
			}
			img.prototype.src = function() {
				return "images/img_" + this.name + ".jpg";
			}
			img.prototype.tag = function(){
				alphabet = "ABCDEFGHIJK";
				return alphabet.charAt(this.name - 1);
			}

			function shuffle(a) {
				var j, x, i;
				for (i = a.length - 1; i > 0; i--) {
					j = Math.floor(Math.random() * (i + 1));
					x = a[i];
					a[i] = a[j];
					a[j] = x;
				}
				return a;
			}


			// initialize data set
			for(var i = 0; i < TOTAL; ++i) {
				imgSet.push(new img(i + 1));
				currSet.push(new img(i +1));
			}
			reset();
			
			// END initialize.

			function reset() {
				title.innerText = "Round 1";
				currSet = shuffle(currSet);
				imgLeft.src = currSet[0].src();
				imgRight.src = currSet[1].src();
				imgLeft.style.cursor = "pointer";
				imgRight.style.cursor = "pointer";
				document.getElementById('btn-reset').hidden = "hidden";
				endFlag = false;
				li = 0;
				ri = 1;
			}

			function end() {
				if(endFlag) return;				
				imgLeft.style.cursor = "default";
				imgRight.style.cursor = "default";
				document.getElementById('btn-reset').hidden = "";
				title.innerText = title.innerText + ": Winner is " + currWinner.tag();
				endFlag = true;
			}
	
			function leftClick() {		
				if(li == currSet.length - 1 || ri == currSet.length - 1)	{
					currWinner = currSet[li];
					end();
					return;
				}
				// choose a new ri
				if(ri < li) ri = li + 1;
				else ri++;													
				if(ri < currSet.length) {
					imgRight.src = currSet[ri].src();					
					currSet[li].rank++;			
					currWinner = currSet[li];
				}								
				else {
					end();
				}
				
			}
			function rightClick(){
			
				if(li == currSet.length - 1 || ri == currSet.length - 1)	{
					currWinner = currSet[ri];
					end();
					return;
				}

				// choose a new li
				if(li < ri) li = ri + 1;
				else li++;

				if(li < currSet.length) {
					imgLeft.src = currSet[li].src();
					currSet[ri].rank++;
					currWinner = currSet[ri];
				}
				else {
					end();
				}
				
			}
			
		</script>
	</body>
</html>